<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    #parse("/easyuiTemplate/head.html")  
	<script>
	   // 权限控制使用到以下2个参数
  		var authLevel="${authLevel}";
  		var menuId="${menuId}";
  		// 
  		$(function(){
  			
  			// 初始化表格
  			dataGrid = $('#dataGrid').datagrid({  
  		        url: sysUtil.bp()+'/reportQuery/get'+'${report.code}'+'GridData',
  		        fitColumns:true,
  		      	border:true,
  		        singleSelect:true,
  		        fit:true,
  		    	columnsfit:true,
  		        pagination:true,
  		        pageSize:16,
  		        pageList:[16,50,100,200],
  		        loadFilter:function(data){
  		        	var dataMeta = [];
  					if (data.success){
  						var list = data.obj.rows;
  						dataMeta['total'] = data.obj.total;
  						dataMeta['rows'] = list;
  						return dataMeta;
  					}else{
  						dataMeta['total'] = 0;
  						dataMeta['rows'] = [];
  						$.messager.show({
  							title : '错误',
  							msg : data.errMsg,
  							timeout : 3000
  						});
  					}
  		        },  
  		        columns:[[
  					#foreach( $column in $gridColumns )
  						 {field:'$column.field',title:'$column.title',width:'$column.width',align:'$column.align'
  						  #if($column.formatter && $column.formatter!="")
  							  ,formatter:function(val){
  								  $column.formatter
  					  			}
  						  #end
  						 }
  						#if($velocityCount!=$gridColumns.size())
  						,
  						#end
  					#end
  		        ]],
  		        toolbar:[]
  			});
  			
  			
  			$('#select').live('click',function(){
  	        	var queryParams = $('#selectForm').form('serialize');
  	 			dataGrid.datagrid('options').queryParams= queryParams;   
  	 			dataGrid.data().datagrid.cache = null; 
  				dataGrid.datagrid('load');
  	        });
  		
  			
  		})
  		
  	</script>
	
  </head>
  <body>
 <body class="easyui-layout" style="overflow:hidden" loadingMessage="请等待数据加载....." fit="true">
	  	<div region="center" border="true">
	  		 <form id="selectForm">
  		 		<table style="font-size:12px;margin-left:10px;">
	  		 		<tr>
	  		 			#foreach( $param in $params )
						   <td>${param.name}：</td>
	  						<td>
	  							 #if ( $param.widgetType=="text" )
	  								<input name="$param.code" type="text" class="easyui-validatebox" />
	  							 #end
	  							 #if ( $param.widgetType=="number" )
	  								<input name="$param.code" type="text" class="easyui-numberbox" />
	  							 #end
	  							 #if ( $param.widgetType=="select" )
	  								<select name="$param.code" type="text" class="easyui-combobox"  style="width:120px;"> </select>
	  							 #end
	  						</td>
						#end
			  	 	 	<td><a href="javascript:void(0)" plain="true" id="select" class="easyui-linkbutton" iconCls="icon-search">查询</a> </td>
			  	 	 </tr>
	  		 	</table>
			  </form>
			  
			  
			  <div id="myTabs" class="easyui-tabs" style="width:100%;height:100%;" fit="true">
			   #if($stringUtil.contains($report.reportShowWay,"0"))
			    <div title="表格" id="gridResult" style="padding:20px;">
					<div style="width:98%;height:90%;margin:10 10 10 10">
		  				<table id="dataGrid" class="esayui"></table>
	  			   </div>
			    </div>
			    #end
			     #if($stringUtil.contains($report.reportShowWay,"1"))
			    <div title="柱状图" id="barResult" data-options="" >
					tab2
			    </div>
			    #end
			     #if($stringUtil.contains($report.reportShowWay,"2"))
			    <div title="曲线图" id="lineResult" data-options="" >
					tab3
			    </div>
			    #end
			</div>
			  
	  		<!-- <div style="width:98%;height:90%;margin:10 10 10 10">
		  		<table id="dataGrid" class="esayui"></table>
	  		</div> -->
		</div>
  </body>
</html>